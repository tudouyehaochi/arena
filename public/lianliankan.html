<!DOCTYPE html>
<html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>æ°´æœè¿è¿çœ‹</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:linear-gradient(135deg,#ffecd2,#fcb69f);min-height:100vh;display:flex;flex-direction:column;align-items:center;font-family:sans-serif}
h1{margin:16px 0 6px;font-size:26px;color:#d35400;text-shadow:1px 1px 0 #fff}
.info{display:flex;gap:20px;margin-bottom:8px;font-size:15px;color:#6d4c41}
.info span{background:#fff8;padding:3px 12px;border-radius:10px}
#board{display:grid;gap:3px;padding:8px;background:#fff5;border-radius:12px;box-shadow:0 4px 20px #0002;position:relative}
.c{width:52px;height:52px;display:flex;align-items:center;justify-content:center;font-size:30px;background:#fff;border-radius:8px;cursor:pointer;transition:transform .1s,box-shadow .1s,opacity .3s;user-select:none;border:2px solid transparent}
.c:hover{transform:scale(1.07);box-shadow:0 2px 8px #0003}
.c.sel{border-color:#e74c3c;box-shadow:0 0 10px #e74c3c88;transform:scale(1.09)}
.c.gone{opacity:0;pointer-events:none}.c.mt{background:transparent;pointer-events:none;cursor:default}
.c.mt:hover{transform:none;box-shadow:none}
canvas#cv{position:absolute;top:0;left:0;pointer-events:none;z-index:10}
.btn{margin:12px 5px;padding:9px 24px;font-size:15px;border:none;border-radius:9px;cursor:pointer;color:#fff;background:#e67e22;box-shadow:0 2px 6px #0002}
.btn:hover{background:#d35400}
.win{font-size:20px;color:#27ae60;font-weight:bold;margin:14px 0}
</style></head><body>
<h1>ğŸ‰ æ°´æœè¿è¿çœ‹ ğŸ“</h1>
<div class="info"><span>â± <b id="tm">0</b>s</span><span>ğŸ¯ <b id="rm">0</b></span><span>ğŸ† <b id="sc">0</b></span></div>
<div id="board"></div><div id="wm"></div>
<div><button class="btn" onclick="init()">ğŸ”„ é‡æ¥</button><button class="btn" onclick="hint()">ğŸ’¡ æç¤º</button><button class="btn" onclick="shuf()">ğŸ”€ é‡æ’</button></div>
<script>
const F=['ğŸ','ğŸŠ','ğŸ‹','ğŸ‡','ğŸ‰','ğŸ“','ğŸ‘','ğŸ’','ğŸ¥','ğŸŒ','ğŸ','ğŸ«','ğŸ¥­','ğŸˆ'],R=8,C=10;
let g,sel,sc,rem,tv,ti;
function rnd(a){for(let i=a.length-1;i>0;i--){const j=Math.random()*(i+1)|0;[a[i],a[j]]=[a[j],a[i]]}}
function init(){
  clearInterval(ti);sc=0;tv=0;$('sc').textContent=0;$('tm').textContent=0;$('wm').textContent='';
  const n=(R-2)*(C-2);let p=[];
  for(let i=0;i<n/2;i++)p.push(F[i%F.length],F[i%F.length]);
  rnd(p);g=Array.from({length:R},()=>Array(C).fill(null));let x=0;
  for(let r=1;r<R-1;r++)for(let c=1;c<C-1;c++)g[r][c]=p[x++];
  rem=p.length;$('rm').textContent=rem;sel=null;draw();
  ti=setInterval(()=>{tv++;$('tm').textContent=tv},1000);
}
function $(id){return document.getElementById(id)}
function gc(r,c){return document.querySelector(`[data-r="${r}"][data-c="${c}"]`)}
function draw(){
  const b=$('board');b.style.gridTemplateColumns=`repeat(${C},52px)`;b.innerHTML='';
  for(let r=0;r<R;r++)for(let c=0;c<C;c++){
    const d=document.createElement('div');d.className='c'+(g[r][c]?'':' mt');
    d.textContent=g[r][c]||'';d.dataset.r=r;d.dataset.c=c;
    if(g[r][c])d.addEventListener('click',()=>click(r,c,d));b.appendChild(d);
  }
}
function click(r,c,d){
  if(!g[r][c])return;
  if(sel&&sel.r===r&&sel.c===c){d.classList.remove('sel');sel=null;return}
  if(!sel){sel={r,c};d.classList.add('sel');return}
  const p=sel,path=fp(p.r,p.c,r,c),pc=gc(p.r,p.c);
  if(g[p.r][p.c]===g[r][c]&&path){
    dp(path);setTimeout(()=>{
      g[p.r][p.c]=null;g[r][c]=null;
      if(pc){pc.classList.add('gone');pc.classList.remove('sel')}d.classList.add('gone');
      rem-=2;sc+=10;$('rm').textContent=rem;$('sc').textContent=sc;
      const cv=$('cv');if(cv)cv.remove();
      if(rem===0){clearInterval(ti);$('wm').innerHTML=`<span class="win">ğŸ‰ é€šå…³ï¼ç”¨æ—¶${tv}ç§’ å¾—åˆ†${sc}</span>`}
    },320);sel=null;
  }else{if(pc)pc.classList.remove('sel');sel={r,c};d.classList.add('sel')}
}
function lo(r1,c1,r2,c2){
  if(r1===r2){const[a,b]=c1<c2?[c1,c2]:[c2,c1];for(let c=a+1;c<b;c++)if(g[r1][c])return false;return true}
  if(c1===c2){const[a,b]=r1<r2?[r1,r2]:[r2,r1];for(let r=a+1;r<b;r++)if(g[r][c1])return false;return true}
  return false;
}
function fp(r1,c1,r2,c2){
  if((r1===r2||c1===c2)&&lo(r1,c1,r2,c2))return[[r1,c1],[r2,c2]];
  if(!g[r1][c2]&&lo(r1,c1,r1,c2)&&lo(r1,c2,r2,c2))return[[r1,c1],[r1,c2],[r2,c2]];
  if(!g[r2][c1]&&lo(r1,c1,r2,c1)&&lo(r2,c1,r2,c2))return[[r1,c1],[r2,c1],[r2,c2]];
  for(let c=0;c<C;c++){if(c===c1||c===c2)continue;if(!g[r1][c]&&!g[r2][c]&&lo(r1,c1,r1,c)&&lo(r1,c,r2,c)&&lo(r2,c,r2,c2))return[[r1,c1],[r1,c],[r2,c],[r2,c2]]}
  for(let r=0;r<R;r++){if(r===r1||r===r2)continue;if(!g[r][c1]&&!g[r][c2]&&lo(r1,c1,r,c1)&&lo(r,c1,r,c2)&&lo(r,c2,r2,c2))return[[r1,c1],[r,c1],[r,c2],[r2,c2]]}
  return null;
}
function dp(path){
  const b=$('board');let cv=$('cv');if(cv)cv.remove();
  cv=document.createElement('canvas');cv.id='cv';cv.width=b.offsetWidth;cv.height=b.offsetHeight;b.appendChild(cv);
  const ctx=cv.getContext('2d');ctx.strokeStyle='#e74c3c';ctx.lineWidth=3;ctx.lineJoin='round';ctx.beginPath();
  const s=55;for(let i=0;i<path.length;i++){const x=path[i][1]*s+26,y=path[i][0]*s+26;i===0?ctx.moveTo(x,y):ctx.lineTo(x,y)}ctx.stroke();
}
function hint(){
  for(let r1=0;r1<R;r1++)for(let c1=0;c1<C;c1++){if(!g[r1][c1])continue;
    for(let r2=r1;r2<R;r2++)for(let c2=(r2===r1?c1+1:0);c2<C;c2++){
      if(!g[r2][c2]||g[r1][c1]!==g[r2][c2])continue;
      if(fp(r1,c1,r2,c2)){const a=gc(r1,c1),b=gc(r2,c2);
        if(a)a.style.background='#ffe0b2';if(b)b.style.background='#ffe0b2';
        setTimeout(()=>{if(a)a.style.background='';if(b)b.style.background=''},1200);return}
  }}alert('æ²¡æœ‰å¯æ¶ˆé™¤çš„é…å¯¹ï¼Œè¯•è¯•é‡æ’ï¼');
}
function shuf(){
  let t=[];for(let r=1;r<R-1;r++)for(let c=1;c<C-1;c++)if(g[r][c])t.push(g[r][c]);
  rnd(t);let x=0;for(let r=1;r<R-1;r++)for(let c=1;c<C-1;c++)if(g[r][c])g[r][c]=t[x++];
  sel=null;draw();
}
init();
</script></body></html>
